<!DOCTYPE html>
<html>

  <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>MacBook MacOS OSX</title>
      <meta name="viewport" content="width=device-width">
      <meta name="description" content="I am writing here some toughts during my work in Ruby on Rails, Javascript and other">
      <link rel="shortcut icon" type="image/png" href="/assets/favicon.png"/>

      <!-- Custom CSS -->
      <link rel="stylesheet" href="/assets/css/main.css">
      <link rel="stylesheet" href="/assets/css/toc.css">

  </head>

  <body>

    <header class="site-header">

      <div class="wrap">

        <a class="site-title" href="/">duleorlovic - web developer</a>

        <nav class="site-nav">
          <a href="#" class="menu-icon">
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
               viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
              <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
                h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
                h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
                c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </a>
          <div class="trigger">
            
              <a class="page-link" href="/about/">About</a>
            
              
            
              
            
              
            
          </div>
        </nav>
        <small>tools like
          <a href=" 
            /2015/04/05/common-rails-bootstrap-snippets/"
            >Rails bootstrap</a>,
          <a href=" /2015/11/09/rails-testing/">Rails testing</a>
            and <a href=" 
            /2016/04/12/rails-tips/">Rails tips</a>
          are still in use so content can be updated!
          <a href="javascript:void(0)"
            onclick="document.getElementById('mc_embed_signup').classList.toggle('active');">Notify
          me</a>
        </small>
	  <!-- Begin MailChimp Signup Form -->
	  <link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
	  <style type="text/css">
		  #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
		  /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
		     We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
	  </style>
	  <div id="mc_embed_signup" class="signup-form">
	    <form action="//trk.us14.list-manage.com/subscribe/post?u=819590ae53cb08bddb952ed97&amp;id=ec1213024d" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
		<div id="mc_embed_signup_scroll">
	    <div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
	    <div class="mc-field-group">
		    <label for="mce-EMAIL">Email Address  <span class="asterisk">*</span>
	    </label>
		    <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
	    </div>
		    <div id="mce-responses" class="clear">
			    <div class="response" id="mce-error-response" style="display:none"></div>
			    <div class="response" id="mce-success-response" style="display:none"></div>
		    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
		<div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_819590ae53cb08bddb952ed97_ec1213024d" tabindex="-1" value=""></div>
		<div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
		</div>
	    </form>
	  </div>
	  <script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
	  <!--End mc_embed_signup-->

      </div>
    <!-- Html Elements for Search -->
    <div id="search-demo-container">
    <input type="text" id="search-input" placeholder="search...">
    <ul id="results-container"></ul>
    </div>

    <!-- Script pointing to jekyll-search.js -->
    <script src="/bower_components/simple-jekyll-search/dest/jekyll-search.js" type="text/javascript"></script>
    <script>
      SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('results-container'),
        json: '/search.json',
      });
    </script>

    </header>
    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>MacBook MacOS OSX</h1>
    <p class="meta">May 23, 2017</p>
  </header>

  <article class="post-content">
  <body><div id="toc-container"><table class="toc" id="toc"><tbody><tr><td><div id="toctitle"><h2>Contents</h2></div><ul><li class="toc_level-1 toc_section-1"><a href="#shortcuts"><span class="tocnumber">1</span> <span class="toctext">Shortcuts</span></a></li><li class="toc_level-1 toc_section-2"><a href="#karabiner-elements-to-change-keys"><span class="tocnumber">2</span> <span class="toctext">Karabiner Elements to change keys</span></a></li><li class="toc_level-1 toc_section-3"><a href="#update-packages"><span class="tocnumber">3</span> <span class="toctext">Update packages</span></a></li><li class="toc_level-1 toc_section-4"><a href="#iterm2"><span class="tocnumber">4</span> <span class="toctext">iTerm2</span></a></li><li class="toc_level-1 toc_section-5"><a href="#tips"><span class="tocnumber">5</span> <span class="toctext">Tips</span></a></li><li class="toc_level-1 toc_section-6"><a href="#applescript"><span class="tocnumber">6</span> <span class="toctext">AppleScript</span></a></li><li class="toc_level-1 toc_section-7"><a href="#activate-window"><span class="tocnumber">7</span> <span class="toctext">Activate window</span></a></li><li class="toc_level-1 toc_section-8"><a href="#rails"><span class="tocnumber">8</span> <span class="toctext">Rails</span></a></li><li class="toc_level-1 toc_section-9"><a href="#mysql"><span class="tocnumber">9</span> <span class="toctext">Mysql</span></a></li><li class="toc_level-1 toc_section-10"><a href="#errors"><span class="tocnumber">10</span> <span class="toctext">Errors</span></a></li><li class="toc_level-1 toc_section-11"><a href="#android-usb-thethering"><span class="tocnumber">11</span> <span class="toctext">Android USB Thethering</span></a></li><li class="toc_level-1 toc_section-12"><a href="#defaults"><span class="tocnumber">12</span> <span class="toctext">Defaults</span></a></li><li class="toc_level-1 toc_section-13"><a href="#logs"><span class="tocnumber">13</span> <span class="toctext">Logs</span></a></li><li class="toc_level-1 toc_section-14"><a href="#closed-lid"><span class="tocnumber">14</span> <span class="toctext">Closed lid</span></a></li><li class="toc_level-1 toc_section-15"><a href="#tips-1"><span class="tocnumber">15</span> <span class="toctext">Tips</span></a></li><li class="toc_level-1 toc_section-16"><a href="#docker"><span class="tocnumber">16</span> <span class="toctext">Docker</span></a></li><li class="toc_level-1 toc_section-17"><a href="#pyenv-global-2718"><span class="tocnumber">17</span> <span class="toctext">pyenv global 2.7.18</span></a></li><li class="toc_level-1 toc_section-18"><a href="#install-pyenv-to-bashrc-by-copy-paste-script-from"><span class="tocnumber">18</span> <span class="toctext">install pyenv to .bashrc by copy paste script from</span></a></li><li class="toc_level-1 toc_section-19"><a href="#pathpyenv-rootshimspath"><span class="tocnumber">19</span> <span class="toctext">PATH=$(pyenv root)/shims:$PATH</span></a></li></ul></td></tr></tbody></table></div><p>Macbook Aur M1 2020
specification https://support.apple.com/kb/SP825?viewlocale=en_US&amp;locale=en_US</p>

<h1 id="shortcuts">Shortcuts</h1>

<p>Option (ALT) key is ⌥
Command cmd key is ⌘
Shift key is ⇧ 
Return key is ↵ 
Control (CTRL) key is ^</p>

<p>Since on mac keyboard <code class="language-plaintext highlighter-rouge">fn</code> key is at left edge, I use it as <code class="language-plaintext highlighter-rouge">ctrl</code> . Remap with
System preferences -&gt; Keyboard -&gt; Modifier Keys -&gt; Globe key -&gt; ^Control</p>

<p>Xkill on macOS is Force Quit Applications which can be started with ⌘ ⌥ Esc</p>

<p>To start inserting emoji use: Control + Command + Space</p>

<p>https://support.apple.com/en-gb/HT201236</p>

<p>In any window, or shell, you can:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">⌘ n</code> new window</li>
  <li><code class="language-plaintext highlighter-rouge">⌘ t</code> new tab, <code class="language-plaintext highlighter-rouge">⌘ w</code> close tab</li>
  <li><code class="language-plaintext highlighter-rouge">⌘ ,</code> cmd + comma, open preferences, I have remaped this to <code class="language-plaintext highlighter-rouge">⇧⌘,</code> shift cmd
comma since I use cmd + jklm,. for quick window navigations</li>
</ul>

<p>Another interesting keyboard shortcut is <code class="language-plaintext highlighter-rouge">⌥ ⌘</code> option + cmd and double click on
the icon in Applications folder, it works for Photos app and it shows: “Repair
Library”, “You are about to repair the library ‘Photos Library’”.</p>

<p>From System Preferences -&gt; Keyboard -&gt; Shortcuts</p>
<ul>
  <li>Spotlight
    <ul>
      <li><code class="language-plaintext highlighter-rouge">⌘ space</code> spotlight search</li>
      <li><code class="language-plaintext highlighter-rouge">⌥  ⌘ space</code> finder search, inside finder you can open files with double click or <code class="language-plaintext highlighter-rouge">⌘ o</code> (enter just renames the file)</li>
    </ul>
  </li>
  <li>Mission control
    <ul>
      <li><code class="language-plaintext highlighter-rouge">^ up</code> mission control</li>
      <li><code class="language-plaintext highlighter-rouge">^ down</code> application windows in all workspaces, use arrow to focus, use tab
to select another application and view it’s windows</li>
    </ul>
  </li>
  <li>Screenshot
    <ul>
      <li><code class="language-plaintext highlighter-rouge">⌘ shift 3</code> and <code class="language-plaintext highlighter-rouge">⌘ shift 4</code> to create screenshots for entire and selected
area. Press space after <code class="language-plaintext highlighter-rouge">⌘ shift 4</code> to select window. Screen shots will be
on desktop but I changed to Downloads using <code class="language-plaintext highlighter-rouge">cmd shift 5</code> (record video).
iphone screenshot use power button and home buttom (or volume up if home
button does not exists)
When you connect with usb cable, the Dusan’s iPhone will show up in finder
so you can browser files on phone from mac, if iCloud Photos is not used on
a phone. If it is used than access with https://www.icloud.com</li>
    </ul>
  </li>
</ul>

<p>https://support.apple.com/en-gb/guide/terminal/trmlshtcts/mac
Typing Command-Full Stop (.) Dot Period is equivalent to entering Control-C on
the command line.</p>

<p>With <code class="language-plaintext highlighter-rouge">fn F3</code> (or swipe up with three fingers) you can create new spaces (any
number of workspaces) desktops. You can switch between them with left/right
swipe with three fingers and you can drag and drop to different workspaces.
Full screen apps open their own space.
From <a href="https://support.apple.com/en-us/HT201236">Mac keyboard shortcuts from
support</a></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">⌘ H</code> hide front app</li>
  <li><code class="language-plaintext highlighter-rouge">⌘ ⌥ H</code> to show only front app</li>
  <li><code class="language-plaintext highlighter-rouge">Fn-delete</code> is forward del since that key does not exists on macbook air</li>
</ul>

<p>Click on link by holding ⌘ or ⌥ or ctrl will open new tab (with shift it will
focus that new tab), download and open context menu (ctrl click also works for
selected text).</p>

<p>To use apple keyboard on ubuntu I tried to remap Fn key, but that is not
possible https://askubuntu.com/questions/370944/remap-fn-key-to-insert-key-on-apple-aluminium-keyboard</p>

<p>To connect two monitors on one port you need adapter that supports mst dual external displays https://www.reddit.com/r/UsbCHardware/comments/jmaa2t/anyway_to_use_two_monitors_on_a_laptop_with_one/
For M1 is it not enough to use two ports with two adapters. you need to use usb
A to hdmi adapter that is DisplayLink compatible:
https://www.youtube.com/watch?v=y_WHjdiqCMc
driver https://www.synaptics.com/products/displaylink-graphics/downloads/macos
list
https://www.synaptics.com/products/displaylink-graphics/displaylink-products-list?field_displaylink_category_value=usb_adapters
long description
https://www.macworld.co.uk/how-to/how-connect-two-or-more-external-displays-apple-silicon-m1-mac-3799794/</p>

<p>Another solution using magiclink cable
https://www.youtube.com/watch?v=GPWuABthnkE</p>

<p>To show home folder in Finder, go to Finder Preferences -&gt; Sidebar and enable
home folder in sidebar.
Inside Finder Go menu you can hold ⌥  key to show <code class="language-plaintext highlighter-rouge">Library</code> folder. It is by
default hidden from user. To permanently enable showing it, go to home folder in
finder app, right click on empty space and choose ‘Show View Options’ from
dropdown. Than select ‘Show Library Folder’.
Some app data can be
<code class="language-plaintext highlighter-rouge">~/Library/Containers/com.mydomain.myaoo/Data/Library/Application%20Support/myapp/</code>
When you open the app using ⌘ + space than it is usually from Applications
folder, but it could be from Downloads. You can check where app is location by
right clicking on app icon in Dock than Options -&gt; Show in finder</p>

<p>I added to <code class="language-plaintext highlighter-rouge">.bash_profile</code>:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">alias ls='ls -Gp'</code> so I can see difference between files and folders</li>
</ul>

<p>To enable ssh server you need to go “System Preferences -&gt; Sharing -&gt; enable
Remote login”</p>

<p>To rename hostname go to System preferences -&gt; Sharing</p>

<p>Position windows using <a href="https://github.com/eczarny/spectacle">spectacle</a>
<a href="https://www.youtube.com/watch?v=k1lmd2T5Z2A">video</a>.
Comparison of all
<a href="https://css-tricks.com/os-x-window-manager-apps/">os-x-windoiw-manager</a>.
I found interesting
<a href="http://www.hammerspoon.org/go/">hammerspoon</a>
<a href="http://thume.ca/2016/07/16/advanced-hackery-with-the-hammerspoon-window-manager/">blog</a></p>

<h1 id="karabiner-elements-to-change-keys">Karabiner Elements to change keys</h1>

<p>Former name for this app was KeyRemap4MacBook.
https://github.com/pqrs-org/Karabiner-Elements</p>

<p>Install instructions https://karabiner-elements.pqrs.org/docs/getting-started/installation/
after allowing karabiner_oberver you need to manually add also the
karabiner_grabber by selecting Machintos HD -&gt; /Library/Application
Support/org.pqrs/Karabiner-Elements/bin/karabiner_grabber
https://github.com/pqrs-org/Karabiner-Elements/issues/1867#issuecomment-498484832</p>

<p>I use following scripts for complex modifications
https://github.com/pqrs-org/KE-complex_modifications
You can find this site in Karabiner -&gt; Complex rules -&gt; Add rule -&gt; Import more
rules from the internet</p>
<ul>
  <li>semicolon and colon https://superuser.com/a/1705236/877698</li>
  <li>curly braces and square brackets https://apple.stackexchange.com/a/437073/449651
https://ke-complex-modifications.pqrs.org/#exchange_square_brackets_and_curly_brackets</li>
  <li>Remap section sign (§) from British Keyboard to US’s backtick + plus minus (±)
to tilde (~) grave_accent_and_tilde
https://ke-complex-modifications.pqrs.org/#section_sign_to_backtick</li>
  <li>Exchange single and double quote
https://ke-complex-modifications.pqrs.org/#exchange_single_and_double_quote</li>
  <li>Exchange numbers and symbols (1234567890 and !@#$%^&amp;*())
https://ke-complex-modifications.pqrs.org/#exchange_numbers_and_symbols</li>
  <li>
    <p>Left ctrl + hjkl to arrow keys Vim
https://ke-complex-modifications.pqrs.org/#ctrl_plus_hjkl_to_arrow_keys
but I change to caps_lock</p>
  </li>
  <li>Caps Lock Vim Movements (rev 2)
https://ke-complex-modifications.pqrs.org/#capslock_vim_movements</li>
  <li>custom rule similar to single and double quote, I created for pipe and
backslash. I just duplicated existing rule</li>
</ul>

<p>Changes are visible immediatelly, but I do not use links, I copy from config</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cp ~/.config/karabiner/karabiner.json ~/config/.config/karabiner/karabiner.json
cp ~/config/.config/karabiner/karabiner.json ~/.config/karabiner/karabiner.json
</code></pre></div></div>

<p>I added my config to enable bash alt + b/f back forward one word. I need to
enable in Termial -&gt; Preferences -&gt; Profiles -&gt; Keyboard -&gt; Use Option as Meta
key
Also remaped cmd+. to cmd+\ since default keyboard shortcut is Break but not in
menu bar, so now I remap to cmd+\ and use another automator to
activateWindowDotByBackslash and bind to cmd+<br />
https://stackoverflow.com/questions/71347942/change-command-dot-break-keyboard-shortcut-in-terminal-mac-which-is-not-in/71347943#71347943</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                "rules": [
                    {
                        "description": "Change left_command+b/f to alt+b/f and left_control [/] to page up/down",
                        "manipulators": [
                            {
                                "conditions": [
                                    {
                                        "bundle_identifiers": [
                                            "^com\\.apple\\.Terminal$"
                                        ],
                                        "type": "frontmost_application_if"
                                    }
                                ],
                                "from": {
                                    "key_code": "period",
                                    "modifiers": {
                                        "mandatory": [
                                            "left_command"
                                        ]
                                    }
                                },
                                "to": [
                                    {
                                        "key_code": "backslash",
                                        "modifiers": [
                                            "left_command"
                                        ]
                                    }
                                ],
                                "type": "basic"
                            },
                            {
                                "conditions": [
                                    {
                                        "bundle_identifiers": [
                                            "^com\\.apple\\.Terminal$"
                                        ],
                                        "type": "frontmost_application_if"
                                    }
                                ],
                                "from": {
                                    "key_code": "b",
                                    "modifiers": {
                                        "mandatory": [
                                            "left_command"
                                        ],
                                        "optional": [
                                            "any"
                                        ]
                                    }
                                },
                                "to": [
                                    {
                                        "key_code": "b",
                                        "modifiers": [
                                            "option"
                                        ]
                                    }
                                ],
                                "type": "basic"
                            },
                            {
                                "conditions": [
                                    {
                                        "bundle_identifiers": [
                                            "^com\\.apple\\.Terminal$"
                                        ],
                                        "type": "frontmost_application_if"
                                    }
                                ],
                                "from": {
                                    "key_code": "f",
                                    "modifiers": {
                                        "mandatory": [
                                            "left_command"
                                        ],
                                        "optional": [
                                            "any"
                                        ]
                                    }
                                },
                                "to": [
                                    {
                                        "key_code": "f",
                                        "modifiers": [
                                            "option"
                                        ]
                                    }
                                ],
                                "type": "basic"
                            },
                            {
                                "from": {
                                    "key_code": "open_bracket",
                                    "modifiers": {
                                        "mandatory": [
                                            "fn"
                                        ],
                                        "optional": [
                                            "any"
                                        ]
                                    }
                                },
                                "to": [
                                    {
                                        "key_code": "page_down"
                                    }
                                ],
                                "type": "basic"
                            },
                            {
                                "from": {
                                    "key_code": "close_bracket",
                                    "modifiers": {
                                        "mandatory": [
                                            "fn"
                                        ],
                                        "optional": [
                                            "any"
                                        ]
                                    }
                                },
                                "to": [
                                    {
                                        "key_code": "page_up"
                                    }
                                ],
                                "type": "basic"
                            }
                        ]
                    },
</code></pre></div></div>

<h1 id="update-packages">Update packages</h1>

<p>Install homebrew
Update bash: <code class="language-plaintext highlighter-rouge">brew install bash</code>
<a href="https://gist.github.com/xuhdev/8b1b16fb802f6870729038ce3789568f">link</a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew install coreutils findutils gnu-tar gnu-sed gawk gnutls gnu-indent gnu-getopt
brew info coreutils

brew install bash-completion
</code></pre></div></div>

<p>Edit Terminal background I tried to be as it is on ubuntu
Chose Pro profile on Terminal -&gt; Preferences -&gt; Profiles
https://medium.com/@json_singh/ubuntu-like-terminal-in-mac-bash-9afe37b09aa</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew install bash

sudo vi /etc/shells
# add
/opt/homebrew/bin/bash

# and now changing the shell will succeed
chsh -s /opt/homebrew/bin/bash
</code></pre></div></div>
<p>Also change font to Monospace Regular style (you can see it on ubuntu terminall
Preferences -&gt; Default -&gt; Text) and size 14.
You can also use Ubuntu Mono Regular https://design.ubuntu.com/font/.
Copy ttf file to Libraries (in finder use menu item Go -&gt; Library).</p>

<p>Also in terminal profiles Pro select: When the shell exists: “Close if the shell
exited cleanly”.</p>

<p>Install <a href="https://yousseb.github.io/meld/">meld for mac</a></p>

<p>On high sierra you need to run <a href="https://github.com/yousseb/meld/issues/50">https://github.com/yousseb/meld/issues/50</a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>unlink /Applications/Meld.app/Contents/Frameworks/libz.1.dylib
</code></pre></div></div>

<p>Install java JRE from jre-9.0.4_osx-x64_bin.dmg (not tar.gz)
http://www.oracle.com/technetwork/java/javase/downloads/index.html
Double click will install.
You can check if installed using https://java.com/en/download/installed.jsp in
browser.</p>

<p>Install vim</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew install vim --override-system-vi
# if you receive error
# xcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: /Library/Developer/CommandLineTools/usr/bin/xcrun
xcode-select --install
</code></pre></div></div>

<p>Instal pip</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo easy_install-3.6 pip
pip3 install awscli  --user --upgrade
</code></pre></div></div>

<h1 id="iterm2">iTerm2</h1>

<p>You can maps pageup in iterm.  Do <code class="language-plaintext highlighter-rouge">⌘ ,</code> to open Preferences -&gt; Keys -&gt; Key
mappings and add <code class="language-plaintext highlighter-rouge">⌘ [</code> and <code class="language-plaintext highlighter-rouge">⌘ ]</code> to map scroll page down and up. But that does
not work well for vim since it show previous page in terminal buffer (not in
vim) so for vim use <code class="language-plaintext highlighter-rouge">^b</code> and <code class="language-plaintext highlighter-rouge">^f</code> (<code class="language-plaintext highlighter-rouge">^d</code> and <code class="language-plaintext highlighter-rouge">^u</code> for half down up)</p>

<h1 id="tips">Tips</h1>

<ul>
  <li>new disks like sd card will be mounted under <code class="language-plaintext highlighter-rouge">/Volumes</code> instead of <code class="language-plaintext highlighter-rouge">/media</code> or
<code class="language-plaintext highlighter-rouge">/mnt</code></li>
</ul>

<h1 id="applescript">AppleScript</h1>

<p>You can run and edit scripts in <code class="language-plaintext highlighter-rouge">Script Editor</code>. Open <code class="language-plaintext highlighter-rouge">Dictionary</code> in File-&gt;Open
Dictionary or drag application icon to Script Editor application icon.</p>

<p>https://www.youtube.com/watch?v=EAZlFptgEPQ</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># comments
-- this is comment
# this is also comment
{* multi 
line
comment *}

# continuation character Option l
dialog "This is long line" ¬
buttons { "Great", "OK" }

# Boolean
true, false
# Text
"Hi"
# List
{ 1, "Duke" }
# Record
{name: "Duke", age: 35}

# Operators
"a" &amp; "b"

# variables
set myName to "John"
copy 33 to myAge
</code></pre></div></div>

<p>Send keys</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>" you can use app Key codes to find a code
key code 36
keystroke "ASD"
# you can use keystroke to send shortcuts
https://eastmanreference.com/complete-list-of-applescript-key-codes
delay 1
</code></pre></div></div>

<p>Statements can include all above. Simple statement is single line, multiline is
compound statements</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tell application "Finder"
  -- by position index, first/last or front/back, name
  get the name of window 2
  -- same as get the name of second window
  -- same as get the name of 2nd window
  -- same as get the name of the window after the front window
  -- same as get the name of window "Trash"

  -- name can not be updated, but other (like index) can be updated
  set the index of the last window to 1
  set toolbar visible of the front Finder window to true
  set the sidebar width of  the second Finder window to 240
  set the position of the front Finder window to {94, 134}
  set the bounds of the front Finder window to {24, 96, 524, 396}
  set the target of the front Finder window to home

  open window "Trash"
  -- same as select window "Trash"
  tell the front window
    set the current view to flow view
    set the bounds to {528, 116, 1016, 674}
  end tell

  close window "Trash"
  set savedName to name of front window
  set windowRef to a reference to window 1
  set windowId to theWindow's id
  -- same as set windowId to id of the first window

end tell
</code></pre></div></div>

<p>If conditional with type casting</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if (myVar as string) is equal to "asd" then
end if
</code></pre></div></div>

<p>If you want to check the type of variable</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if class of myVar is string then
end if
</code></pre></div></div>

<p>If you got exception than wrap with try to do exceptions handling</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>try
    set a to a as number
    display dialog "Yes! It's a number!"
end try

-- or

try
  set windowId to do shell script "defaults read com.duleorlovic.windowShortCuts " &amp; key
on error
  display dialog "Please create window shortcut for key "
end try
</code></pre></div></div>

<p>Get user input</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set theResponse to display dialog "Key (h, j, k, l, semicolon, m, comma, dot, slash, u, i) ?" default answer "" with icon note buttons {"Cancel", "Continue"} default button "Continue"
if button returned of theResponse is equal to "Cancel" then
 error number -128
end if
set key to text returned of theResponse
</code></pre></div></div>

<p>Sample programs
https://en.wikibooks.org/wiki/AppleScript_Programming/Sample_Programs</p>

<p>Command is series of words that request an action. Command is directed to a
target.
Choose file</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    set xfile to choose file
    set xpath to POSIX path of xfile
</code></pre></div></div>

<p>Debugging with <code class="language-plaintext highlighter-rouge">display dialog "message"</code>. Use double quotes, not single quote.</p>

<p>Array list iterate loop</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set theList {1, 2, 3}
set first as item 1 of theList
set first to item 1 of theList
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>on getPositionOfItemInList(theItem, theList)
    repeat with a from 1 to count of theList
        if item a of theList is theItem then return a
    end repeat
    return 0
end getPositionOfItemInList

set theList to {"Sal", "Ben", "David", "Chris", "Jen", "Lizzie", "Maddie", "Lillie"}
getPositionOfItemInList("Maddie", theList)
</code></pre></div></div>

<p>String manipulation https://developer.apple.com/library/content/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/ManipulateText.html</p>

<p>Split string</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set AppleScript's text item delimiters to "-"
set theTextItems to every text item of windowNameId
set AppleScript's text item delimiters to ""
set windowId to item 2 of the theTextItems
</code></pre></div></div>

<p>You can run scripts inside bash with <code class="language-plaintext highlighter-rouge">osascript -e 'display dialog "Hi"'</code> or for
shell scripts (you need to <code class="language-plaintext highlighter-rouge">chmod +x filename.txt</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#!/usr/bin/osascript
display dialog "Hi"
</code></pre></div></div>

<p>You can also call scpt file</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>osascript ~/myscript.scpt
</code></pre></div></div>

<p>TODO: https://developer.apple.com/library/content/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW1</p>

<h1 id="activate-window">Activate window</h1>

<p>iTerm supports hotkeys https://www.iterm2.com/documentation-hotkey.html
but it is not generic. I rather write window id and hotkey combination in user
store using a <code class="language-plaintext highlighter-rouge">b</code> or <code class="language-plaintext highlighter-rouge">b h</code> commands</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>do shell script "defaults write com.myname.myapp foo bar"
set myValue to do shell script "defaults read com.myname.myapp foo"
</code></pre></div></div>

<p>To assign keyboard shortcuts you need to create a service in Automator and
create shortcut in System Preferences -&gt; Keyboard -&gt; Shortcuts -&gt; Services
That is available in all apps, you can find them on main menu using app name on
top left position -&gt; Services. If there is already some shortcut than you need
to remap it to another key, I use same with a shift.</p>

<p>Create service for each key, for example activateWindowL
(<code class="language-plaintext highlighter-rouge">/home/orlovic/Library/Services/activateWindowL.workflow</code>).</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>on run {input, parameters}
    -- note that mac path is using colons instead of slash
    run script file "Macintosh HD:Users:dule:config:bashrc:mac_scripts:mac_activate_window.scpt" with parameters {"l"}
    return input
end run
</code></pre></div></div>

<p>Or you can copy all</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cp -r ~/config/bashrc/mac_scripts/Library/Services/* ~/Library/Services/
# copy back the changes so we can save them in repo
cp -r ~/Library/Services/* ~/config/bashrc/mac_scripts/Library/Services/
</code></pre></div></div>
<p>For Input Sources I changed keyboard shortcut key <code class="language-plaintext highlighter-rouge">ctrl+space</code> <em>Select the
previous input source</em> to <code class="language-plaintext highlighter-rouge">shift+ctrl+space</code> (so I do not accidentally hold ctrl
and space) and change kayboard language.
You can disable any special key for any app so we can use it for our navigation.
From System Preferences -&gt; Keyboard -&gt; Shortcuts -&gt; App Chortcuts -&gt; +  than
select the app and write exact name and add shortcut uncluding ⌥  key:</p>
<ul>
  <li>for iTerm I do not need Clear Buffer so now it is <code class="language-plaintext highlighter-rouge">⌘ ⌥ M</code></li>
  <li>Mission control -&gt; Move left space I remaped to <code class="language-plaintext highlighter-rouge">^ ⌘ h</code> (also right space
<code class="language-plaintext highlighter-rouge">^ ⌘ l</code>)</li>
  <li>to disable hide front app, it has to be done for each app, for example, <code class="language-plaintext highlighter-rouge">Hide
Terminal</code> should be remaped to cmd + shift + h . You can find this menu item
in first menu dropdown.
here is the list of all mappings:</li>
  <li>All Applications: Minimise <code class="language-plaintext highlighter-rouge">⇧ ⌘ J</code></li>
  <li>Finder: Connect to Server <code class="language-plaintext highlighter-rouge">⇧ ⌘ K</code></li>
  <li>Terminal: Clear to Previous Mark <code class="language-plaintext highlighter-rouge">⇧ ⌘ L</code>, Jump to Selection <code class="language-plaintext highlighter-rouge">⇧ ⌘ J</code>, Clear to
Start <code class="language-plaintext highlighter-rouge">⇧ ⌘ K</code>, Hide Terminal <code class="language-plaintext highlighter-rouge">⇧ ⌘ H</code></li>
  <li>Google Chrome: Hide Google Chrome <code class="language-plaintext highlighter-rouge">⇧ ⌘ H</code>, Jump to Selection <code class="language-plaintext highlighter-rouge">⇧ ⌘ J</code>, Open
Location… <code class="language-plaintext highlighter-rouge">⇧ ⌘ L</code></li>
  <li>Preview: Rotate Left <code class="language-plaintext highlighter-rouge">⇧ ⌘ L</code></li>
  <li>Firefox: Downloads <code class="language-plaintext highlighter-rouge">⇧ ⌘ J</code>, Hide Firefox  <code class="language-plaintext highlighter-rouge">⇧ ⌘ H</code></li>
</ul>

<p><img src="/assets/posts/mac keyboard shortcuts.png" alt="Mac keyboard shortcuts" /></p>

<p>My custom keyboard shortcuts</p>
<ul>
  <li>Mission Controller -&gt; Move left a space fn + cmd + h and Move right a space fn
    <ul>
      <li>cmd + l</li>
    </ul>
  </li>
</ul>

<p><img src="/assets/posts/overwrite app shortcuts.png" alt="Overwrite app shortcuts" /></p>

<p>To get foremost window</p>

<p>https://apple.stackexchange.com/questions/117421/how-do-i-focus-a-specific-window-with-applescript-without-doing-an-activate-and
https://stackoverflow.com/questions/10366003/applescript-google-chrome-activate-a-certain-window/34375804#34375804
http://tom.scogland.com/blog/2013/06/08/mac-raise-window-by-title/
https://macosxautomation.com/applescript/firsttutorial/index.html chap 3 name
property</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># open last window
do shell script "open -a Google\\ Chrome"
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tell application "iTerm"
       activate
       set theWindow to the first item of ¬
               (get the windows whose name is "2. bash")
       if index of theWindow is not 1 then
               set index to 1
               set visible to false
               set visible to true
       end if
end tell
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tell application "System Events" to tell process "iTerm"
       perform action "AXRaise" of (first window whose name contains "2.")
end tell
</code></pre></div></div>

<h1 id="rails">Rails</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew unlink imagemagick
brew install imagemagick@6 &amp;&amp; brew link imagemagick@6 --force
brew install qt
</code></pre></div></div>

<h1 id="mysql">Mysql</h1>

<p><code class="language-plaintext highlighter-rouge">brew install mysql</code> will will use <code class="language-plaintext highlighter-rouge">/tmp/mysql.sock</code> so you can create link to
ubuntu folder of mysql socket file</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo mkdir -p /var/run/mysqld
sudo ln -s /tmp/mysql.sock /var/run/mysqld/mysqld.sock
</code></pre></div></div>

<p>To start mysql server you can run</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql.server start
</code></pre></div></div>
<p>For error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Starting MySQL
. ERROR! The server quit without updating PID file (/opt/homebrew/var/mysql/air.local.pid).
</code></pre></div></div>
<p>try to reinstall
https://stackoverflow.com/a/36156848</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew remove mysql@8.0
brew cleanup
launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist
rm ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist
sudo rm -rf /opt/homebrew/var/mysql

brew install mysql@8.0
mysqld --initialize --explicit_defaults_for_timestamp
mysql.server start # no sudo!
</code></pre></div></div>

<p>To find location of mysql config files</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew --prefix mysql
ls  -la $(brew --prefix mysql)
find /opt/homebrew/Cellar/mysql/8.0.28_1 -name "*.cnf"
vi /opt/homebrew/Cellar/mysql/8.0.28_1/.bottle/etc/my.cnf
</code></pre></div></div>
<p>To permanently change socket file location you can update</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># find all places where mysql is searching for my.cnf
mysql --help|grep cnf

sudo vi ~/.my.cnf
[client]
socket=/var/run/mysqld/mysqld.sock
</code></pre></div></div>

<p>To see error log</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tail -f /usr/local/var/mysql/mac.local.err
</code></pre></div></div>

<p>Usually enable permissions for <code class="language-plaintext highlighter-rouge">sudo chown _mysql /usr/local/var/mysql/*</code> but it
is easier to enable for all</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo chmod -R 777 /usr/local/var/mysql/
sudo chmod 777  /var/run/mysqld/
</code></pre></div></div>

<h1 id="errors">Errors</h1>

<p>On Mac I got error for libsassc</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Caused by:
LoadError: Could not open library '/Users/dule/.rvm/gems/ruby-2.6.5/gems/sassc-2.2.1/lib/sassc/libsass.bundle': dlopen(/Users/dule/.rvm/gems/ruby-2.6.5/gems/sassc-2.2.1/lib/sassc/libsass.bundle, 5): no suitable image found.  Did find:
	/Users/dule/.rvm/gems/ruby-2.6.5/gems/sassc-2.2.1/lib/sassc/libsass.bundle: load commands not in a segment
	/Users/dule/.rvm/gems/ruby-2.6.5/gems/sassc-2.2.1/lib/sassc/libsass.bundle: stat() failed with errno=25
</code></pre></div></div>
<p>which I solved with
https://github.com/sass/sassc-ruby/issues/146#issuecomment-534668663</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem uninstall sassc
gem install sassc -- --disable-march-tune-native
</code></pre></div></div>

<p>For error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Could not find MIME type database in the following locations:
</code></pre></div></div>
<p>I use
https://stackoverflow.com/questions/69248078/mimemagic-install-error-could-not-find-mime-type-database-in-the-following-loc</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew install shared-mime-info
</code></pre></div></div>

<p>For error libv8 therubyracer</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>../src/utils.h:33:10: fatal error: 'climits' file not found

</code></pre></div></div>
<p>I used https://github.com/rubyjs/libv8/issues/312#issuecomment-807104369
to install old x86 version of v8
(they also suggest to upgrade to ruby 2.7.1
https://github.com/rubyjs/libv8/issues/312#issuecomment-1023055391 )
We can also replace therubyracer with mini_racer
https://github.com/rubyjs/libv8/issues/282#issuecomment-778845927 and
https://github.com/rubyjs/libv8/issues/309</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew install v8
gem install libv8 -v '3.16.14.19' -- --with-system-v8

gem install libv8-node -v '16.10.0.0' -- --with-system-v8

pyenv global 3.9.1

gem install mini_racer -- --with-v8-dir=`brew --prefix v8`
gem install therubyracer -v '0.12.3' -- --with-v8-dir=`brew --prefix v8`
</code></pre></div></div>

<p>Also do cleanup before installing</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem uninstall --all mini_racer libv8-node
</code></pre></div></div>

<p>for error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>checking for -lmysqlclient... no
-----
mysql client is missing. You may need to 'brew install mysql' or 'port install
mysql', and try again.
</code></pre></div></div>
<p>I solved with</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew install mysql
We've installed your MySQL database without a root password. To secure it run:
    mysql_secure_installation

MySQL is configured to only allow connections from localhost by default

To connect run:
    mysql -uroot

To restart mysql after an upgrade:
  brew services restart mysql
Or, if you don't want/need a background service you can just run:
  /opt/homebrew/opt/mysql/bin/mysqld_safe --datadir=/opt/homebrew/var/mysql
</code></pre></div></div>

<p>For error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ld: library not found for zstd
</code></pre></div></div>
<p>I solved https://stackoverflow.com/a/69722047/287166</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bundle config --local build.mysql2 "--with-opt-dir="$(brew --prefix zstd)""
</code></pre></div></div>
<p>For error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>=&gt; Pouring openjdk@11--11.0.20.1.x86_64_linux.bottle.tar.gz
Error: Too many open files @ rb_sysopen - /home/linuxbrew/.linuxbrew/Cellar/openjdk@11/11.0.20.1/libexec/lib/libjimage.so
</code></pre></div></div>
<p>solved</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ulimit -n 8192
</code></pre></div></div>

<p>For error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERROR:  Error installing jekyll:
	ERROR: Failed to build gem native extension.

    current directory: /Users/dule/.rvm/gems/ruby-3.0.2/gems/eventmachine-1.2.7/ext
compiling binder.cpp
In file included from binder.cpp:20:
./project.h:119:10: fatal error: 'openssl/ssl.h' file not found
#include &lt;openssl/ssl.h&gt;

# or
ruby 3.1.0 error: incomplete definition of type 'struct TS_verify_ctx'
# or
rvm install 3 ossl_pkey_rsa.c:950:5: error: use of undeclared identifier 'RSA_SSLV23_PADDING'
</code></pre></div></div>

<p>RVM NEEDS PKD_CONFIG_PATH set to old openssl using</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PKG_CONFIG_PATH="$(brew --prefix openssl@1.1)/lib/pkgconfig" rvm reinstall 2.6.8 --with-out-ext=fiddle
# or
PKG_CONFIG_PATH="$(brew --prefix openssl@1.1)/lib/pkgconfig" bundle
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew info openssl
If you need to have openssl@1.1 first in your PATH run:
  echo 'export PATH="$(brew --prefix openssl@1.1)/bin:$PATH"' &gt;&gt; ~/.zshrc

For compilers to find openssl@1.1 you may need to set:
export LDFLAGS="-L$(brew --prefix openssl@3)/lib"
export CPPFLAGS="-I$(brew --prefix openssl@3)/include"

For pkg-config to find openssl@1.1 you may need to set:
  export PKG_CONFIG_PATH="$(brew --prefix openssl@1.1)/lib/pkgconfig"

</code></pre></div></div>

<p>for grpc https://github.com/grpc/grpc/issues/30976#issuecomment-1299550028
you can either</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># recompile ruby

# gem install
gem install grpc -v 1.48.0 -- --with-ldflags="-Wl,-undefined,dynamic_lookup"

# bundle config
bundle config build.grpc --with-ldflags="-Wl,-undefined,dynamic_lookup"
</code></pre></div></div>

<p>when you also need to install ffi than join path with colon <code class="language-plaintext highlighter-rouge">:</code>
ffi error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>install ruby closure.c:264:14: error: implicit declaration of function 'ffi_prep_closure' is invalid in C99 [-Werror,-Wimplicit-function-declaration]
</code></pre></div></div>
<p>so I solved with steps for rvm
https://github.com/ffi/ffi/issues/869#issuecomment-810890178
https://github.com/ffi/ffi/issues/869#issuecomment-1233000037</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export LDFLAGS="-L/opt/homebrew/opt/libffi/lib"
export CPPFLAGS="-I/opt/homebrew/opt/libffi/include"
export PKG_CONFIG_PATH="/opt/homebrew/opt/libffi/lib/pkgconfig:$(brew --prefix openssl@1.1)/lib/pkgconfig"
export RUBY_CFLAGS=-DUSE_FFI_CLOSURE_ALLOC
bundle update ffi
# or
rvm reinstall 2.6.8
</code></pre></div></div>

<p>No need for –with-openssl-dir since it does not help</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--with-openssl-dir=`brew --prefix openssl@1.1`
</code></pre></div></div>
<p>I solved with</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># uninstall old version global and bundle
bundle remove eventmachine
gem uninstall -aIx eventmachine 

# configure
# this will raise error for C extension
# bundle config build.eventmachine --with-cppflags=-I$(brew --prefix openssl)/include
bundle config build.eventmachine --with-openssl-dir=$(brew --prefix openssl@1.1)
bundle install
# or just a gem
gem install eventmachine -- --with-cppflags=-I$(brew --prefix openssl)/include
# or set the system
brew link --force openssl
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export RUBY_CONFIGURE_OPTS="--with-openssl-dir=`brew --prefix openssl@1.1`"
</code></pre></div></div>

<p>To install old ruby 2.6.7 for error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vm.c:2295:9: error: implicit declaration of function 'rb_native_mutex_destroy' is invalid in C99 
</code></pre></div></div>
<p>we need</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CFLAGS="-Wno-error=implicit-function-declaration" rbenv install 2.6.7
</code></pre></div></div>
<p>but ruby 2.6.7 EOL so can not install on m1, and you should use 2.7.0</p>

<p>For error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>closure.c:264:14: error: implicit declaration of function 'ffi_prep_closure' is invalid in C99
</code></pre></div></div>
<p>you can use</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RUBY_CFLAGS=-DUSE_FFI_CLOSURE_ALLOC rbenv install 2.7.0
</code></pre></div></div>

<p>Puma 5.6.4 has problems with ssl
https://github.com/puma/puma/issues/2839#issuecomment-1086147152</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LoadError: dlopen(/Users/dule/.rvm/gems/ruby-3.0.2/gems/puma-5.6.4/lib/puma/puma_http11.bundle, 0x0009): symbol not found in flat namespace '_SSL_get1_peer_certificate' - /Users/dule/.rvm/gems/ruby-3.0.2/gems/puma-5.6.4/lib/puma/puma_http11.bundle
</code></pre></div></div>
<p>which I solved with</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem uninstall puma
DISABLE_SSL=1 bundle

# or for new apps
DISABLE_SSL=1 rails new
</code></pre></div></div>
<p>Also you can compile with flags</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem install puma -v 5.6.5 -- --with-cppflags=-I`brew --prefix openssl@3`/include --with-ldflags=-L`brew --prefix openssl@3`/lib
</code></pre></div></div>

<p>For event machine
https://github.com/eventmachine/eventmachine/issues/960</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Users/dule/.rvm/gems/ruby-3.0.2/gems/bootsnap-1.11.1/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require': dlopen(/Users/dule/.rvm/gems/ruby-3.0.2/gems/eventmachine-1.2.7/lib/rubyeventmachine.bundle, 0x0009): symbol not found in flat namespace '_SSL_get1_peer_certificate' - /Users/dule/.rvm/gems/ruby-3.0.2/gems/eventmachine-1.2.7/lib/rubyeventmachine.bundle (LoadError)
</code></pre></div></div>
<p>I solved with</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Gemfile
gem 'eventmachine', github: "eventmachine/eventmachine", branch: 'master'
</code></pre></div></div>

<p>For error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Unable to load the EventMachine C extension; To use the pure-ruby reactor, require 'em/pure_ruby'
</code></pre></div></div>
<p>I have no solutions.</p>

<p>For error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-bash: fork: retry: Resource temporarily unavailable
</code></pre></div></div>
<p>you have reached maximum number of proccesses</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ulimit -u
</code></pre></div></div>

<p>For error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> xcodebuild[92386:809018] [MT] DVTPlugInLoading: Failed to load code for plug-in com.apple.dt.IDESimulatorAvailability (/Applications/Xcode.app/Contents/PlugIns/IDESimulatorAvailability.ideplugin), error = Error Domain=NSCocoaErrorDomain Code=3588 "dlopen(/Applications/Xcode.app/Contents/PlugIns/IDESimulatorAvailability.ideplugin/Contents/MacOS/IDESimulatorAvailability, 0x0109): Symbol not found: (_OBJC_CLASS_$_SimDiskImage)
</code></pre></div></div>
<p>I solved by starting xcode and it will install some development tools.</p>

<h1 id="android-usb-thethering">Android USB Thethering</h1>

<p>Download <a href="http://www.joshuawise.com/horndis">http://www.joshuawise.com/horndis</a> driver (right click open with) to
enable usb tethering from android phone (wireless thethering will consume
batery). I needed to restart mac to find my phone in network preferences.</p>

<h1 id="defaults">Defaults</h1>

<p>Mac user defaults are preferences for user system configurations</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>defaults read com.mydomain.myapp
defaults read com.mydomain.myapp "MyKey"
defaults write com.mydomain.myapp "MyKey" myvalue
defaults delete com.mydomain.myapp
</code></pre></div></div>

<h1 id="logs">Logs</h1>

<p>You can see logs using <code class="language-plaintext highlighter-rouge">console</code> application. You can attach iPhone and see logs
for it. Filter in <code class="language-plaintext highlighter-rouge">Search</code>, follow last logs with <code class="language-plaintext highlighter-rouge">Now</code> button.</p>

<h1 id="closed-lid">Closed lid</h1>

<p>To keep working after lid is closed you can use app https://github.com/semaja2/InsomniaX and disable Idle Sleep and Disable Lid Sleep</p>

<p>Open new VLC in separate window using</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Applications/VLC.app/Contents/MacOS/VLC &amp;
</code></pre></div></div>

<h1 id="tips-1">Tips</h1>

<p>Re-install node</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew uninstall --ignore-dependencies node icu4c
brew install node
brew link --overwrite node
</code></pre></div></div>

<p>Reinstall node-gyp https://github.com/nodejs/node-gyp/issues/1694
https://github.com/nodejs/node-gyp/issues/809</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rm package-lock.json &amp;&amp; rm -rf node_modules &amp;&amp; rm -rf ~/.node-gyp
yarn upgrade
yarn
</code></pre></div></div>

<p>Reinstall postgres and postgis</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew update; brew reinstall postgresql; brew reinstall postgis
</code></pre></div></div>

<p>To start postgres</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew services restart postgresql
ps auxwww | grep postgres
psql
</code></pre></div></div>

<p>see logs with</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat /opt/homebrew/var/log/postgresql@14.log 
pg_ctl -D /usr/local/var/postgres -l /usr/local/var/postgres/server.log start
# upgrade datatabases
rm -rf /usr/local/var/postgres &amp;&amp; initdb /usr/local/var/postgres -E utf8
# or if you have multiple versions you need to initialize specific version
initdb /opt/homebrew/var/postgresql@14
</code></pre></div></div>

<h1 id="docker">Docker</h1>

<p>Download docker desktop 4.5.0
https://docs.docker.com/desktop/mac/release-notes/</p>

<p>reinstall with https://github.com/docker/for-mac/issues/6145#issuecomment-1076397390
https://github.com/docker/for-mac/issues/6324#issuecomment-1143953963
https://stackoverflow.com/questions/44346109/how-to-easily-install-and-uninstall-docker-on-macos/65468254#65468254</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rm -rf ~/Library/Caches/com.docker.docker
rm -rf ~/.docker
rm -rf ~/Library/Group Containers/group.com.docker

brew install --cask docker

open --background -a Docker
</code></pre></div></div>
<p>To move dataFolder you can create a symlink to external storage</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ls -s /Volumes/eksterni/docker_containers/Docker.raw /Users/dule/Library/Containers/com.docker.docker/Data/vms/0/data/Docker.raw
</code></pre></div></div>
<p>Change config does not help since for some reason docker will not start</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi ~/Library/Group\ Containers/group.com.docker/settings.json
# "filesharingDirectories": [
  # eksterni does not work, not sure why, probably because it is usb
  "dataFolder": "/Volumes/eksterni/docker_containers/DockerDesktop",
  # sshfs also does not work
  "dataFolder": "/Users/dule/rails_main/docker_data",
  # local folders works
  "dataFolder": "/Users/dule/docker_data",
  "dataFolder": "/Users/dule/Library/Containers/com.docker.docker/Data/vms/0/data",
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">docker-compose build</code> can raise an error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>macos FileNotFoundError: [Errno 2] No such file or directory  During handling of the above exception, another exception occurred:
</code></pre></div></div>
<p>solution is to start <code class="language-plaintext highlighter-rouge">Docker Desktop</code></p>

<p>If <code class="language-plaintext highlighter-rouge">curl</code> inside <code class="language-plaintext highlighter-rouge">Dockerfile</code> raise error</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>segmentation fault
</code></pre></div></div>
<p>solution is for M1 to define <code class="language-plaintext highlighter-rouge">platform: linux/amd64</code>
https://github.com/docker-library/php/issues/1176#issuecomment-901896821</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Dockerfile
version: '3.9'
services:
  web:
    platform: linux/amd64
    build: .
</code></pre></div></div>

<p>Starting rails can raise</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>web_1  | /usr/local/bundle/gems/rb-inotify-0.10.1/lib/rb-inotify/notifier.rb:69:in `initialize': Function not implemented - Failed to initialize inotify (Errno::ENOSYS)
web_1  | 	from /usr/local/bundle/gems/listen-3.7.0/lib/listen/adapter/linux.rb:29:in `new'
</code></pre></div></div>
<p>solution is to disable inotify file watcher
https://github.com/evilmartians/terraforming-rails/issues/34#issuecomment-872021786</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># config/environments/development.rb
# config.file_watcher = ActiveSupport::EventedFileUpdateChecker
</code></pre></div></div>
<p>or update bin <code class="language-plaintext highlighter-rouge">docker-compose run web rake app:update:bin</code>
https://stackoverflow.com/questions/69773109/how-to-fix-function-not-implemented-failed-to-initialize-inotify-errnoenos</p>

<ul>
  <li>to open iphone emulator from terminal you can try (note it does not contain
app store)
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>open -a Simulator.app
</code></pre></div>    </div>
  </li>
  <li>open android emulator android studio
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Volumes/eksterni/AndroidSDK/emulator/emulator -list-avds
/Volumes/eksterni/AndroidSDK/emulator/emulator @Pixel_3a_API_Tiramisu
/Volumes/eksterni/AndroidSDK/platform-tools/adb kill-server
</code></pre></div>    </div>
  </li>
</ul>

<p>Toggle software keyboard inside simulator with I/O -&gt; Keyboard -&gt; Toggle
software keyboard cmd + K
You can not send SMS to simulatork
https://help.apple.com/simulator/mac/current/#/devb0244142d</p>

<p>watch network requests
https://mdapp.medium.com/the-android-emulator-and-charles-proxy-a-love-story-595c23484e02</p>

<ul>
  <li>safari show link on hover link preview at the bottom footer, Go to View =&gt;
Show Status Bar</li>
  <li>to take camera picture photo you can open <em>Photo Booth</em> app</li>
  <li>iphone icons https://developer.apple.com/sf-symbols/ https://github.com/cyanzhong/sf-symbols-online</li>
  <li>to install old python 2 you can not use
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew install python@2
Warning: No available formula with the name "python@2". Did you mean ipython, bpython, jython or cython?
</code></pre></div>    </div>
    <p>but you can install https://github.com/pyenv/pyenv
```
brew install pyenv
pyenv install 2.7.18</p>
    <h1 id="pyenv-global-2718">pyenv global 2.7.18</h1>
    <p>pyenv versions</p>
  </li>
</ul>

<h1 id="install-pyenv-to-bashrc-by-copy-paste-script-from">install pyenv to .bashrc by copy paste script from</h1>
<h1 id="pathpyenv-rootshimspath">PATH=$(pyenv root)/shims:$PATH</h1>
<p>eval “$(pyenv init -)”</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
To set python version to current shell
</code></pre></div></div>
<p>pyenv shell 2.7.18</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
For error
</code></pre></div></div>
<p>lease use python3.9 or python3.8 or python3.7 or python3.6.
Node.js configure: Found Python 3.11.2…</p>
<pre><code class="language-`">use
https://gist.github.com/fernandoaleman/868b64cd60ab2d51ab24e7bf384da1ca?permalink_comment_id=4211086#gistcomment-4211086
</code></pre>
<p>pyenv global 3.9.1</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
* to mount ssh folder, instead of using brew
</code></pre></div></div>
<p>brew install sshfs
  Error: sshfs has been disabled because it requires closed-source macFUSE!</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  you can download
  https://github.com/osxfuse/sshfs/releases

  also https://github.com/osxfuse/osxfuse/releases
  download dmg and install the package

  for error
</code></pre></div></div>
<p>mount_macfuse: the macFUSE kernel extension is not loaded</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  we need to allow
  https://github.com/osxfuse/osxfuse/issues/851#issuecomment-1052261655
  System Preference &gt; Privacy &amp; Security &gt; Privacy &gt; Full Disk Access
  enable Terminal
  and run
</code></pre></div></div>
<p>sudo kextunload -b io.macfuse.filesystems.macfuse</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  Example

</code></pre></div></div>
<p>sshfs orlovic@main:rails/ ~/rails_main/ -ocache=no -onolocalcaches -ovolname=ssh
  sshfs dule@power:. ~/power/ -ocache=no -onolocalcaches -ovolname=ssh</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  unmount and mount in one command:
</code></pre></div></div>
<p>umount -f ~/power; sshfs dule@power:. ~/power/ -ocache=no -onolocalcaches -ovolname=ssh
  # on ubuntu we can use lazy umount because of error umount: /home/dule/power: target is busy.
  sudo umount -l ~/power; sshfs dule@power:. ~/power/
  ```</p>
<ul>
  <li>
    <p>you can use Real VNC to connect to ubuntu (just enable Share -&gt; Remove
desktop) but it shows black screen
Better is to use native vnc clint from Finder -&gt; Go -&gt; Connect to server or
just <code class="language-plaintext highlighter-rouge">open vnc://user@machine</code> (eg <code class="language-plaintext highlighter-rouge">open vnc://dule@power</code>)
Note that on ubuntu you have to do login in order to unlock Keyring (for
example f you have autologin enabled you will not be able to connect with VNC,
it will just ask for password indefinitely, until you open eg Chrome which
will ask you to unlock keyring).
One solution is to set empty Login password
https://linuxconfig.org/how-to-disable-keyring-popup-on-ubuntu Search for
application (not inside Settings) Passwords and Keys &gt; right click on Login &gt;
Insert current password &gt; insert blank password and confirm blank password.
Now you do not need to unlock keyring.
When vnc password is changed, than you will get error <code class="language-plaintext highlighter-rouge">Authentication failed
to "power"</code>. I do not know how to clear saved passwords for Finder.
Another case when <code class="language-plaintext highlighter-rouge">Authentication failed</code> is when you restart but ubuntu but
vnc session is still active (not always). Solution is to restart vnc server on
ubuntu by disabling and enabling remote desktop again (and <code class="language-plaintext highlighter-rouge">Enable Legacy VNC
Protocol</code> should be checked)</p>
  </li>
  <li>airdrop store files in Downloads</li>
  <li>disable popup “Do you want to enable Dictation? To start dictacting press or
choose start dictation from the edit menu” by going to System Preferences &gt;
Keyboard &gt; Dictation tab change keyboard shortcut</li>
  <li>install chroimum browser <code class="language-plaintext highlighter-rouge">brew install chromium --no-quarantine</code> (without no
quarantine there is an error <code class="language-plaintext highlighter-rouge">“Chromium” is damaged and can’t be opened. You
should move it to the Bin. </code></li>
</ul>
</body>
  </article>

  
  
  
  
    
  
  
  
  
  
  
  
  

</div>

      </div>
    </div>

    <style type='text/css'>
      .similar-links {
        display: inline-block;
        padding: 10px;
      }
    </style>
    <footer class="site-footer">

      <div class="wrap">

        <h2 class="footer-heading">duleorlovic - web developer</h2>

        <div class="footer-col-1 column">
          <ul>
            <li><a href="http://duleorlovic.github.io/tips/">short indistinct tips</a></li>
          </ul>
        </div>

        <div class="footer-col-2 column">
          <ul>
            <li>
              <a href="https://github.com/duleorlovic">
                <span class="icon github">
                  <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                     viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                    c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                    c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                    c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                    C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                    c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                    c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                    c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                    c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                  </svg>
                </span>
                <span class="username">duleorlovic</span>
              </a>
            </li>
          </ul>
        </div>

        <div class="footer-col-3 column">
          <p class="text">I am writing here some toughts during my work in Ruby on Rails, Javascript and other</p>
        </div>

      </div>

    </footer>

  </body>
</html>
