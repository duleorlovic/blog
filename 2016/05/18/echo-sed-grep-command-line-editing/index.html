<!DOCTYPE html>
<html>

  <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Echo Sed Grep command line editing</title>
      <meta name="viewport" content="width=device-width">
      <meta name="description" content="I am writing here some toughts during my work in Ruby on Rails, Javascript and other">
      <link rel="shortcut icon" type="image/png" href="/assets/favicon.png"/>

      <!-- Custom CSS -->
      <link rel="stylesheet" href="/assets/css/main.css">
      <link rel="stylesheet" href="/assets/css/toc.css">

  </head>

  <body>

    <header class="site-header">

      <div class="wrap">

        <a class="site-title" href="/">duleorlovic - web developer</a>

        <nav class="site-nav">
          <a href="#" class="menu-icon">
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
               viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
              <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
                h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
                h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
                c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </a>
          <div class="trigger">
            
              <a class="page-link" href="/about/">About</a>
            
              
            
              
            
              
            
          </div>
        </nav>
        <small>tools like
          <a href=" 
            /2015/04/05/common-rails-bootstrap-snippets/"
            >Rails bootstrap</a>,
          <a href=" /2015/11/09/rails-testing/">Rails testing</a>
            and <a href=" 
            /2016/04/12/rails-tips/">Rails tips</a>
          are still in use so content can be updated!
          <a href="javascript:void(0)"
            onclick="document.getElementById('mc_embed_signup').classList.toggle('active');">Notify
          me</a>
        </small>
	  <!-- Begin MailChimp Signup Form -->
	  <link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
	  <style type="text/css">
		  #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
		  /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
		     We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
	  </style>
	  <div id="mc_embed_signup" class="signup-form">
	    <form action="//trk.us14.list-manage.com/subscribe/post?u=819590ae53cb08bddb952ed97&amp;id=ec1213024d" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
		<div id="mc_embed_signup_scroll">
	    <div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
	    <div class="mc-field-group">
		    <label for="mce-EMAIL">Email Address  <span class="asterisk">*</span>
	    </label>
		    <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
	    </div>
		    <div id="mce-responses" class="clear">
			    <div class="response" id="mce-error-response" style="display:none"></div>
			    <div class="response" id="mce-success-response" style="display:none"></div>
		    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
		<div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_819590ae53cb08bddb952ed97_ec1213024d" tabindex="-1" value=""></div>
		<div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
		</div>
	    </form>
	  </div>
	  <script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
	  <!--End mc_embed_signup-->

      </div>
    <!-- Html Elements for Search -->
    <div id="search-demo-container">
    <input type="text" id="search-input" placeholder="search...">
    <ul id="results-container"></ul>
    </div>

    <!-- Script pointing to jekyll-search.js -->
    <script src="/bower_components/simple-jekyll-search/dest/jekyll-search.js" type="text/javascript"></script>
    <script>
      SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('results-container'),
        json: '/search.json',
      });
    </script>

    </header>
    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Echo Sed Grep command line editing</h1>
    <p class="meta">May 18, 2016</p>
  </header>

  <article class="post-content">
  <body><div id="toc-container"><table class="toc" id="toc"><tbody><tr><td><div id="toctitle"><h2>Contents</h2></div><ul><li class="toc_level-1 toc_section-1"><a href="#echo"><span class="tocnumber">1</span> <span class="toctext">Echo</span></a></li><li class="toc_level-1 toc_section-2"><a href="#sed"><span class="tocnumber">2</span> <span class="toctext">Sed</span></a></li><li class="toc_level-1 toc_section-3"><a href="#grep"><span class="tocnumber">3</span> <span class="toctext">Grep</span></a></li><li class="toc_level-1 toc_section-4"><a href="#regex"><span class="tocnumber">4</span> <span class="toctext">Regex</span></a></li><li class="toc_level-1 toc_section-5"><a href="#awk"><span class="tocnumber">5</span> <span class="toctext">AWK</span></a></li><li class="toc_level-1 toc_section-6"><a href="#jq"><span class="tocnumber">6</span> <span class="toctext">jq</span></a></li><li class="toc_level-1 toc_section-7"><a href="#ag"><span class="tocnumber">7</span> <span class="toctext">ag</span></a></li></ul></td></tr></tbody></table></div><h1 id="echo">Echo</h1>

<p><code class="language-plaintext highlighter-rouge">echo -e "\n" &gt;&gt; filename</code> will add new line (that’s why <code class="language-plaintext highlighter-rouge">-e</code> to the
filename). You can use single quotes so you do not need to write <code class="language-plaintext highlighter-rouge">-e</code> and <code class="language-plaintext highlighter-rouge">\n</code>
in multiline text but you need to escape other <code class="language-plaintext highlighter-rouge">'</code>. The best was to write
multiline text is with <code class="language-plaintext highlighter-rouge">cat &gt; filename &lt;&lt; HERE_DOC ... some lines with ' or "
...  HERE_DOC</code>. First <code class="language-plaintext highlighter-rouge">\HERE_DOC</code> or <code class="language-plaintext highlighter-rouge">'HERE_DOC'</code> when no parametar expanded.
Remember to use double <code class="language-plaintext highlighter-rouge">&lt;&lt;</code> not single <code class="language-plaintext highlighter-rouge">&lt;</code> redirection. Inside <code class="language-plaintext highlighter-rouge">HERE_DOC</code> there
should not be backtick  `` since it will be evaluated as shell command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat &gt; my.txt &lt;&lt; 'HERE_DOC'
here can be ' " \ / anything
there is no interpolation
echo multi\
line works with one backslash
HERE_DOC

cat &gt; my.txt &lt;&lt; HERE_DOC
echo single\
line
echo multi\\
line needs two backslashes
HERE_DOC
</code></pre></div></div>

<h1 id="sed">Sed</h1>

<p><code class="language-plaintext highlighter-rouge">sed -i "" -e '/haus/ s/$/home/' filename</code> will inplace (<code class="language-plaintext highlighter-rouge">-i</code>) search for <em>haus</em> and
append <em>home</em> at the end of each line
You can use matched line in result, for example to add quotes <code class="language-plaintext highlighter-rouge">sed 's/.*/"&amp;"/'
filename</code>
You can practice with echo and use <code class="language-plaintext highlighter-rouge">--regexp-extended</code> or <code class="language-plaintext highlighter-rouge">-r</code>, for example
remove lines that begins with <code class="language-plaintext highlighter-rouge">T</code> or <code class="language-plaintext highlighter-rouge">X</code> ignoring space or tabs</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo -e " T\n\t T\nT\n   X" | sed -r -e "/^[[:space:]]*(T|X)/ d"
</code></pre></div></div>

<p>Insert before line <code class="language-plaintext highlighter-rouge">i</code>, append after line <code class="language-plaintext highlighter-rouge">a</code>, <code class="language-plaintext highlighter-rouge">c</code> change matched line,
delete matched line <code class="language-plaintext highlighter-rouge">d</code>, change matched line <code class="language-plaintext highlighter-rouge">s</code>
Multiple lines need to have “" at the end of line because only first line will
be used otherwise.
When using double quotes you also need <code class="language-plaintext highlighter-rouge">\n</code> (last line should not put <code class="language-plaintext highlighter-rouge">\n\ </code>
because you probably do not want to insert blank new line).
With single quotes multiline <code class="language-plaintext highlighter-rouge">echo ' ...'</code> does not need that new line character
(last line should ends with <code class="language-plaintext highlighter-rouge">'</code> because if you put on next line you will insert
blank line).
Double backslash at beggining is needed so first line is properly indented.
Remember that no char (even space) could be after last <code class="language-plaintext highlighter-rouge">\ </code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># double quotes need \n, can close quote in new line, need double \\ at begging
sed -i "" -e "/^end$/i \\
  # root page\n\
  root 'pages#home'\
" config/routes.rb

# single quotes, no need for \n, also no need for \ on first and last line
# if you need ' than you can use '"'"' (this converts to ')
sed -i "" -e '/^end$/i \
  # root page\
  root "pages#home"
' config/routes.rb
</code></pre></div></div>

<p>Most common usage is to add before some line, for example line begins with
<code class="language-plaintext highlighter-rouge">test</code>. If you need single quote <code class="language-plaintext highlighter-rouge">'</code> for example <code class="language-plaintext highlighter-rouge">'a'</code> than you need to use
prefix <code class="language-plaintext highlighter-rouge">$</code> and escape quote with single backslash ` \ <code class="language-plaintext highlighter-rouge">. You could also use
string concatenation: single with double quote string </code>’“‘a’”’<code class="language-plaintext highlighter-rouge">.
If you need </code>"<code class="language-plaintext highlighter-rouge"> than put </code>\”` so backslash survive bash command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sed -i config/secrets.yml -e $'/^test:/i \
  # aws s3\
  aws_bucket_name: &lt;%= ENV[\'AWS_BUCKET_NAME\'] %&gt;'
</code></pre></div></div>

<p>Instead of search, you can append on line numbers <code class="language-plaintext highlighter-rouge">3,6aTEXT</code> or at the last line
<code class="language-plaintext highlighter-rouge">sed '$aTEXT_AT_END</code> (last line is <code class="language-plaintext highlighter-rouge">$</code> or <code class="language-plaintext highlighter-rouge">"\$"</code> if <code class="language-plaintext highlighter-rouge">"</code> is used) or at first
line</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sed -i app/assets/stylesheets/application.scss -e '1i\
/*\
 *= require rails_bootstrap_forms\
 */'
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">sed 's/find/replace/g</code> will replace word <code class="language-plaintext highlighter-rouge">find</code> with <code class="language-plaintext highlighter-rouge">replace</code>.</p>

<p>Brackets need to be escaped like <code class="language-plaintext highlighter-rouge">\(</code>, <code class="language-plaintext highlighter-rouge">\1</code> means first group, <code class="language-plaintext highlighter-rouge">&amp;</code> means matched
text…
<a href="http://www.thegeekstuff.com/2009/10/unix-sed-tutorial-advanced-sed-substitution-examples/">tutorial</a>
Adding <code class="language-plaintext highlighter-rouge">,</code> and new <code class="language-plaintext highlighter-rouge">text</code> after <code class="language-plaintext highlighter-rouge">match</code> could be with <code class="language-plaintext highlighter-rouge">sed
's/\(match.*\)/\1,\ntext/</code></p>

<p>Sed has something different regular expressions so follow this <a href="http://www.gnu.org/software/sed/manual/html_node/Regular-Expressions.html">link</a></p>

<p>When you want to change chars (and not whole line) than you can use <code class="language-plaintext highlighter-rouge">s/me/you/g</code>, or several regexp in same command for example</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sed src/app/index.module.coffee \
  -e 's/, /,\n  /g' \
  -e 's/  \[/\[\n  /g' \
  -e 's/\]/,\n\]/'
</code></pre></div></div>

<p>If you have a lot regexp, than its better to use <a href="http://tldp.org/LDP/abs/html/here-docs.html">here-doc</a>
and read from standard input <code class="language-plaintext highlighter-rouge">-</code> <a href="https://unix.stackexchange.com/questions/45591/using-a-here-doc-for-sed-and-a-file/45592#45592?newreg=39c715cb752f44a9bba9b3f3f74f2015">link</a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sed src/app/index.module.coffee -f - &lt;&lt;HERE_DOC
s/, /,\n  /g
s/  \[/\[\n  /g
s/\]/,\n\]/
HERE_DOC
</code></pre></div></div>

<p>Note that all commands one per line. As with <code class="language-plaintext highlighter-rouge">sed ''</code> you need backslash for each line of multiline command.</p>

<p>When you really need to add multiline template
and don’t want to escape <code class="language-plaintext highlighter-rouge">'</code> and to add “" to the end of each line, than you
can try following command <a href="https://stackoverflow.com/questions/26770426/use-sed-in-bash-to-replace-string-with-heredoc/26770678#26770678">inspiration</a>
which will replace new lines with <code class="language-plaintext highlighter-rouge">ћ</code> (<code class="language-plaintext highlighter-rouge">N</code> means multiline match, <code class="language-plaintext highlighter-rouge">a</code> label… multiline match <code class="language-plaintext highlighter-rouge">:a;N;$!ba;s/\n/ћ/g</code>, note that <code class="language-plaintext highlighter-rouge">$</code> needs to be escaped if inside <code class="language-plaintext highlighter-rouge">""</code>) and than return back new line.</p>

<p>Quote in <code class="language-plaintext highlighter-rouge">'HERE_DOC'</code> will not <a href="http://tldp.org/LDP/abs/html/here-docs.html#EX71C">substitute
params</a> so <code class="language-plaintext highlighter-rouge">$</code> <code class="language-plaintext highlighter-rouge">/</code> or <br />
will remain in here doc. Instead of <code class="language-plaintext highlighter-rouge">&lt;&lt;</code> you can use <code class="language-plaintext highlighter-rouge">&lt;&lt;-</code> and closing HERE_DOC
can be indented with <em>tab</em> character.  For regexp we need to escape <code class="language-plaintext highlighter-rouge">/</code> and **
with <code class="language-plaintext highlighter-rouge">\/</code> and <code class="language-plaintext highlighter-rouge">\\</code> (<code class="language-plaintext highlighter-rouge">s:\\:\\\\:g;s:/:\\/:g</code>)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sed src/app/index.module.coffee -e "s/client/$(sed ':a;N;$!ba;s/\n/ћ/g;s:\\:\\\\:g;s:/:\\/:g;' &lt;&lt;'HERE_DOC'
    I'm "$just"
    some long /'\ multiline &lt;\template&gt;.
HERE_DOC
)/g;s/ћ/\n/g"
</code></pre></div></div>

<p>Sometimes we need to add/replace line with template (not replace regexp)
than we need to move replacing <code class="language-plaintext highlighter-rouge">s/#/\n/g</code> outside of sed since it will
not be applied to new template.
Note than we can’t use inline replacement but we can move tmp file.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sed src/app/index.module.coffee -e "/PLACEHOLDER/a $(sed ':a;N;$!ba;s/\n/ћ/g;s:\\:\\\\:g;s:/:\\/:g;' &lt;&lt;'HERE_DOC'
    I'm "$just"
    some long /'\ multiline &lt;\template&gt;.
HERE_DOC
)" | sed "s/ћ/\n/g" &gt; tmp &amp;&amp; mv tmp src/app/index.module.coffee
</code></pre></div></div>

<p>Here is another solution which replace the PLACEHOLDER line
<a href="https://stackoverflow.com/questions/26770426/use-sed-in-bash-to-replace-string-with-heredoc/26770678#26770678">link</a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat &gt; /tmp/template &lt;&lt;\HEREDOC
    I'm "$just"
    some long /'\ multiline &lt;\template&gt;.
HERE_DOC
sed -i myfile.rb -e '/PLACEHOLDER/ {
  r /tmp/template
  d
}'
rm /tmp/template
</code></pre></div></div>

<p>If you need <code class="language-plaintext highlighter-rouge">sudo</code> than you can use <code class="language-plaintext highlighter-rouge">tee</code> for example</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat &lt;&lt; HERE_DOC | sudo tee -a /etc/systemd/system/mongodb.service
HERE_DOC
</code></pre></div></div>

<h1 id="grep">Grep</h1>

<p>Just a few command line options with grep</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">grep pattern filename</code> so if you omit filename than standard input will be
used, which is nice to test your big regex, for example <code class="language-plaintext highlighter-rouge">asd &lt;&lt;</code> (exit with
Ctrl+d)
    <ul>
      <li><code class="language-plaintext highlighter-rouge">grep "asd &lt;&lt;"</code></li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">grep -o 111</code> will output only matched parts (not whole possible big lines)</li>
  <li><code class="language-plaintext highlighter-rouge">grep -l asd</code> output only filenames</li>
  <li>grep only specific file type is with <code class="language-plaintext highlighter-rouge">grep asd --include \*.yml</code> or with a
find command
    <ul>
      <li><code class="language-plaintext highlighter-rouge">find . -name *.yml -exec grep asd {} \;</code> (this will show the line, not the
filename)</li>
    </ul>
  </li>
  <li>rename could be done with simple regex:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">rename 's/\.in.html.erb/\.html.erb/' app/views/*/*</code></li>
      <li><code class="language-plaintext highlighter-rouge">rename 's/\.in.html.erb/\.html.erb/' app/views/*/*/*</code> for nested folders</li>
    </ul>
  </li>
  <li>if you want to output only matching group than it is better to use <code class="language-plaintext highlighter-rouge">sed</code>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">sed -n 's/^.*[^0-9]\([0-9][0-9]*\).*/\1/p'</code> get only numbers</li>
      <li><code class="language-plaintext highlighter-rouge">echo "asd123" | sed -n 's/asd/***/p'</code> replace asd with <code class="language-plaintext highlighter-rouge">***</code></li>
    </ul>
  </li>
  <li>exclude mathing with <code class="language-plaintext highlighter-rouge">grep -v</code> that is invert match. This is usefull when you
wan to exclude current grep for example <code class="language-plaintext highlighter-rouge">ps aux | grep -v grep | grep
my-process</code></li>
</ul>

<h1 id="regex">Regex</h1>

<p><a href="https://regex101.com/">https://regex101.com/</a> enable multiline flag if you are using <code class="language-plaintext highlighter-rouge">$</code> end of line
<a href="https://github.com/tom-lord/regexp-examples#usage">https://github.com/tom-lord/regexp-examples#usage</a> to show matching examples</p>

<ul>
  <li>OR is with <code class="language-plaintext highlighter-rouge">(|)</code>. But you need to escape <code class="language-plaintext highlighter-rouge">|</code> for example: <code class="language-plaintext highlighter-rouge">\(asd\|qwe\)</code> lines
that contains asd or qwe. We need parentheses because alternator
operator <code class="language-plaintext highlighter-rouge">|</code> has the lowest precedence of all, so usually you want world
boundaries like <code class="language-plaintext highlighter-rouge">^([0-9]|[1-9][0-9])$</code> (0..99, but not 0asd, or asd9</li>
  <li>contains asd but not qwe till the end of line is <code class="language-plaintext highlighter-rouge">asd((?!qwe).)*$</code>. Oposite
for containing (does not include) is using negative lookahead <code class="language-plaintext highlighter-rouge">(?!____)</code> which
asserts that this group does not match</li>
  <li>contains <code class="language-plaintext highlighter-rouge">asd</code> and <code class="language-plaintext highlighter-rouge">qwe</code> but not <code class="language-plaintext highlighter-rouge">zxc</code> in between <code class="language-plaintext highlighter-rouge">asd((?!qwe).)*zxc</code></li>
  <li>include end of line for multiline search, use matcher <code class="language-plaintext highlighter-rouge">\_.</code> finds any
character including end-of-line. Use <code class="language-plaintext highlighter-rouge">\n</code> for new line character for example
<code class="language-plaintext highlighter-rouge">asd(.|\n)*&lt;div&gt;</code>. <code class="language-plaintext highlighter-rouge">\{-}</code> stopping at first occurence early short (<code class="language-plaintext highlighter-rouge">*</code> is too
greedy, eager and would stop at last occurence). If you want ruby regex ignore
new line you can use modifier <code class="language-plaintext highlighter-rouge">m</code> (multiline multi line search), like match all
dl <code class="language-plaintext highlighter-rouge">s.match /dl.*dl/m</code></li>
  <li>to stop at first match use non greedy match, just add <code class="language-plaintext highlighter-rouge">?</code> after <code class="language-plaintext highlighter-rouge">?</code> or <code class="language-plaintext highlighter-rouge">*</code>
or <code class="language-plaintext highlighter-rouge">+</code>, like
<code class="language-plaintext highlighter-rouge">registration_email.html_part.decoded.match(/(http:.*?confirmation.*?)"/)[1]</code>
to grab inside first next <code class="language-plaintext highlighter-rouge">"</code>.</li>
  <li>to match all occurences you can use <code class="language-plaintext highlighter-rouge">"string",scan /(.*?)/</code></li>
  <li>to include matching delimiter when spliting in ruby, instead of
<code class="language-plaintext highlighter-rouge">content.split(/[?.!]/)</code> we can use a positive lookbehind regular expression
(i.e. <code class="language-plaintext highlighter-rouge">?&lt;=</code>) inside a parenthesis capture group to keep the delimiter at the
end of each string <code class="language-plaintext highlighter-rouge">content.split(/(?&lt;=[?.!])/)</code> https://stackoverflow.com/questions/18089562/how-do-i-keep-the-delimiters-when-splitting-a-ruby-string</li>
  <li>match start of line with lowercase <code class="language-plaintext highlighter-rouge">^[a-z]</code> (but one string could have
multiple lines). Better is to check start of string with lowercase <code class="language-plaintext highlighter-rouge">\A[a-z]</code> (in
ruby example) <code class="language-plaintext highlighter-rouge">"123\ntest".match /^[a-z]/</code> will return <code class="language-plaintext highlighter-rouge">t</code>… (you can use
alternative <code class="language-plaintext highlighter-rouge">string.start_with? /^[a-z]/</code></li>
  <li>repetative match is with <code class="language-plaintext highlighter-rouge">{number}</code> like for example for numbers 000…999 use
<code class="language-plaintext highlighter-rouge">^[0-9]{3}$</code>. To find two or more spaces you can use <code class="language-plaintext highlighter-rouge">\s{2,}</code> so 2 is minimum
count of matching chars.</li>
  <li>whitespace <code class="language-plaintext highlighter-rouge">\s</code>, word <code class="language-plaintext highlighter-rouge">\w</code> character</li>
  <li><code class="language-plaintext highlighter-rouge">\A</code> start and <code class="language-plaintext highlighter-rouge">\z</code> end of string. End of world is <code class="language-plaintext highlighter-rouge">asd\b</code>.
That is better than <code class="language-plaintext highlighter-rouge">^</code> (start of line) and
<code class="language-plaintext highlighter-rouge">$</code> (end of line) since that will match until a new line
<code class="language-plaintext highlighter-rouge">asd@asd.asd\n&lt;script&gt;alert('danger')&lt;/script&gt;</code></li>
  <li>replace groups of text with another text that use matching text, for example
add space if there is no space before MAC, <code class="language-plaintext highlighter-rouge">'aMAC'.gsub /([^\s])(MAC)/, '\1
\2'</code></li>
</ul>

<p>When using grep, you can enable Per regexp PCRE with <code class="language-plaintext highlighter-rouge">-P</code> or <code class="language-plaintext highlighter-rouge">--per-regexp</code>.
That is needed for negative lookahead.
When using <code class="language-plaintext highlighter-rouge">-P</code> than no need to escape.
<code class="language-plaintext highlighter-rouge">grep -e pattern</code> is for regexp, but for advances regular expression use</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># find all _url links without email_token param
grep -P '_url((?!email_token).)*$' app/views/user_mailer/*
</code></pre></div></div>
<p>note this is not supported on macOS. For Mac os use <code class="language-plaintext highlighter-rouge">ag</code></p>

<p>In bash you need to escape <code class="language-plaintext highlighter-rouge">()|\</code> (for both single and double quotes).
In vim you also need to escape again (for both single and double quotes):
<code class="language-plaintext highlighter-rouge">grep '\(asd\\|qwe\)'</code> is the same as in vim <code class="language-plaintext highlighter-rouge">:grep '\\(asd\\\|qwe\\)'</code>. Note
When using <code class="language-plaintext highlighter-rouge">-P</code> than no need one escape (vim escape is still required).</p>

<p>In vim <a href="http://vimdoc.sourceforge.net/htmldoc/pattern.html">vim pattern</a> search
inside buffer.</p>

<p>Catastrophic Backtracking</p>

<p>https://www.regular-expressions.info/catastrophic.html</p>

<p>example in ruby is</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"simple_captcha_valid?".match /^([A-Za-z\d*]+)+([\w]*)+([A-Za-z\d*]+)$/
</code></pre></div></div>

<h1 id="awk">AWK</h1>

<ul>
  <li>split by one char: <code class="language-plaintext highlighter-rouge">echo "1:3" | awk '{split($0,a,":");print a[1] a[2]}' # 13</code></li>
  <li>split by multiple char: <code class="language-plaintext highlighter-rouge">echo "1:3x5" | awk -F':|x' '{print $1 $2 $3}' # 135</code></li>
</ul>

<h1 id="jq">jq</h1>

<p>https://stedolan.github.io/jq/tutorial/
or better is to</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>man jq
</code></pre></div></div>
<p>example commands</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat title.json | jq '.'
</code></pre></div></div>
<ul>
  <li>first <code class="language-plaintext highlighter-rouge">[0]</code>, all <code class="language-plaintext highlighter-rouge">[]</code></li>
  <li>get all commit.message <code class="language-plaintext highlighter-rouge">.[] | { message: .commit.message }'</code></li>
  <li>put all inside array <code class="language-plaintext highlighter-rouge">[.[]]</code> also works for nested .parents
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl 'https://api.github.com/repos/stedolan/jq/commits?per_page=5' | jq '[.[] | {message: .commit.message, name: .commit.committer.name, parents: [.parents[].html_url]}]'
</code></pre></div>    </div>
  </li>
</ul>

<h1 id="ag">ag</h1>

<p>fast grep</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># find files with content some_string
ag some_string

# list only filenames
ag -l some_string

</code></pre></div></div>
</body>
  </article>

  
  
  
  
    
  
  
  
  
  
  
  
  

</div>

      </div>
    </div>

    <style type='text/css'>
      .similar-links {
        display: inline-block;
        padding: 10px;
      }
    </style>
    <footer class="site-footer">

      <div class="wrap">

        <h2 class="footer-heading">duleorlovic - web developer</h2>

        <div class="footer-col-1 column">
          <ul>
            <li><a href="http://duleorlovic.github.io/tips/">short indistinct tips</a></li>
          </ul>
        </div>

        <div class="footer-col-2 column">
          <ul>
            <li>
              <a href="https://github.com/duleorlovic">
                <span class="icon github">
                  <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                     viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                    c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                    c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                    c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                    C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                    c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                    c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                    c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                    c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                  </svg>
                </span>
                <span class="username">duleorlovic</span>
              </a>
            </li>
          </ul>
        </div>

        <div class="footer-col-3 column">
          <p class="text">I am writing here some toughts during my work in Ruby on Rails, Javascript and other</p>
        </div>

      </div>

    </footer>

  </body>
</html>
