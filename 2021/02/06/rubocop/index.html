<!DOCTYPE html>
<html>

  <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Rubocop</title>
      <meta name="viewport" content="width=device-width">
      <meta name="description" content="I am writing here some toughts during my work in Ruby on Rails, Javascript and other">
      <link rel="shortcut icon" type="image/png" href="/assets/favicon.png"/>

      <!-- Custom CSS -->
      <link rel="stylesheet" href="/assets/css/main.css">
      <link rel="stylesheet" href="/assets/css/toc.css">

  </head>

  <body>

    <header class="site-header">

      <div class="wrap">

        <a class="site-title" href="/">duleorlovic - web developer</a>

        <nav class="site-nav">
          <a href="#" class="menu-icon">
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
               viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
              <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
                h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
                h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
                c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </a>
          <div class="trigger">
            
              <a class="page-link" href="/about/">About</a>
            
              
            
              
            
              
            
          </div>
        </nav>
        <small>tools like
          <a href=" 
            /2015/04/05/common-rails-bootstrap-snippets/"
            >Rails bootstrap</a>,
          <a href=" /2015/11/09/rails-testing/">Rails testing</a>
            and <a href=" 
            /2016/04/12/rails-tips/">Rails tips</a>
          are still in use so content can be updated!
          <a href="javascript:void(0)"
            onclick="document.getElementById('mc_embed_signup').classList.toggle('active');">Notify
          me</a>
        </small>
	  <!-- Begin MailChimp Signup Form -->
	  <link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
	  <style type="text/css">
		  #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
		  /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
		     We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
	  </style>
	  <div id="mc_embed_signup" class="signup-form">
	    <form action="//trk.us14.list-manage.com/subscribe/post?u=819590ae53cb08bddb952ed97&amp;id=ec1213024d" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
		<div id="mc_embed_signup_scroll">
	    <div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
	    <div class="mc-field-group">
		    <label for="mce-EMAIL">Email Address  <span class="asterisk">*</span>
	    </label>
		    <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
	    </div>
		    <div id="mce-responses" class="clear">
			    <div class="response" id="mce-error-response" style="display:none"></div>
			    <div class="response" id="mce-success-response" style="display:none"></div>
		    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
		<div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_819590ae53cb08bddb952ed97_ec1213024d" tabindex="-1" value=""></div>
		<div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
		</div>
	    </form>
	  </div>
	  <script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
	  <!--End mc_embed_signup-->

      </div>
    <!-- Html Elements for Search -->
    <div id="search-demo-container">
    <input type="text" id="search-input" placeholder="search...">
    <ul id="results-container"></ul>
    </div>

    <!-- Script pointing to jekyll-search.js -->
    <script src="/bower_components/simple-jekyll-search/dest/jekyll-search.js" type="text/javascript"></script>
    <script>
      SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('results-container'),
        json: '/search.json',
      });
    </script>

    </header>
    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Rubocop</h1>
    <p class="meta">Feb 6, 2021</p>
  </header>

  <article class="post-content">
  <body><div id="toc-container"><table class="toc" id="toc"><tbody><tr><td><div id="toctitle"><h2>Contents</h2></div><ul><li class="toc_level-1 toc_section-1"><a href="#standard"><span class="tocnumber">1</span> <span class="toctext">Standard</span></a></li><li class="toc_level-1 toc_section-2"><a href="#rubocop"><span class="tocnumber">2</span> <span class="toctext">Rubocop</span></a></li><li class="toc_level-1 toc_section-3"><a href="#configuration"><span class="tocnumber">3</span> <span class="toctext">Configuration</span></a></li><li class="toc_level-1 toc_section-4"><a href="#extension"><span class="tocnumber">4</span> <span class="toctext">Extension</span></a></li><li class="toc_level-1 toc_section-5"><a href="#ci"><span class="tocnumber">5</span> <span class="toctext">CI</span></a></li><li class="toc_level-1 toc_section-6"><a href="#my-defaults"><span class="tocnumber">6</span> <span class="toctext">My defaults</span></a></li></ul></td></tr></tbody></table></div><h1 id="standard">Standard</h1>

<p>Now we switch to standard gem https://github.com/testdouble/standard
which provides better defaults than rubocop</p>

<p>Install with</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem "standard", "~&gt; 1.0", require: false
</code></pre></div></div>
<p>and add</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># .rubocop.yml
require: standard

inherit_gem:
  standard: config/base.yml
</code></pre></div></div>

<p>If you want to use todos
https://evilmartians.com/chronicles/rubocoping-with-legacy-bring-your-ruby-code-up-to-standard</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># .rubocop.yml
# We want Exclude directives from different
# config files to get merged, not overwritten
inherit_mode:
  merge:
    - Exclude

require:
  # Standard's config uses custom cops, # so it must be loaded
  - standard

inherit_gem:
  standard: config/base.yml
  # You can also choose a Ruby-version-specific config
  # standard: config/ruby-3.0.yml

inherit_from:
  - .rubocop_todo.yml
  - .rubocop_strict.yml
# Sometimes we enable metrics cops
# (which are disabled in Standard by default)
#
# Metrics:
#   Enabled: true

# Global options, like Ruby version
AllCops:
  SuggestExtensions: false
  TargetRubyVersion: 3.2
</code></pre></div></div>

<p>Enable in editors
https://github.com/testdouble/standard#language-server-protocol-support</p>

<h1 id="rubocop">Rubocop</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rubocop my-file.rb
# safe auto correct
rubocop -a
# auto correct all
rubocop -A
# auto correct only layout (formatting offenses)
rubocop -x
# only specific cops
rubocop --only Rails/Blank,Naming/FileName
# add rubocop comments that disable warnings and fix what can be fixes
rubocop --auto-correct --disable-uncorrectable
</code></pre></div></div>

<p>Cache is used by default <code class="language-plaintext highlighter-rouge">AllCopps: UseCache</code> is true and stored in
<code class="language-plaintext highlighter-rouge">~/.cache/rubocop_cache/</code></p>

<h1 id="configuration">Configuration</h1>

<p>https://docs.rubocop.org/rubocop/configuration.html
Default configuration
https://github.com/rubocop-hq/rubocop/blob/master/config/default.yml</p>

<p>Configuration can inherit parent configuration and override (hash are merged or
canceled with <code class="language-plaintext highlighter-rouge">~</code>, other types are overriden.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># rubocop --auto-gen-config # generate .rubocop_todo.yml
inherit_from: .rubocop_todo.yml

Rails/HasAndBelongsToMany:
  Include:
    - app/models/*.rb
  Exclude:
    - app/models/problematic.rb

Layout/LineLength:
  Enabled: false

# info (still returns zero 0 value), refactor, convention, warning, error and fatal.
Lint:
  Severity: error
</code></pre></div></div>

<h1 id="extension">Extension</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># .rubocop.yml
require:
  - ../my/file.rb
  - rubocop-extension
</code></pre></div></div>

<p>Create using https://github.com/rubocop-hq/rubocop-extension-generator</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rubocop-extension-generator rubocop-dependent

</code></pre></div></div>

<p>Instructions
https://docs.rubocop.org/rubocop/development.html</p>

<p>Note pattern
https://github.com/rubocop-hq/rubocop-ast/blob/master/docs/modules/ROOT/pages/node_pattern.adoc</p>

<p>Example how rubocop-rails check if there is an unique index for that column name
https://github.com/rubocop-hq/rubocop-rails/blob/master/lib/rubocop/cop/rails/unique_validation_without_index.rb#L61</p>

<h1 id="ci">CI</h1>

<p>TODO:
https://nvuillam.github.io/mega-linter/installation/ for github action</p>

<p>https://docs.rubocop.org/rubocop/automated_code_review.html for example pronto</p>

<h1 id="my-defaults">My defaults</h1>

<p>Do not use home <code class="language-plaintext highlighter-rouge">~/.rubocop.yml</code> since it can be different for different
projects (it is by default included if there is no local <code class="language-plaintext highlighter-rouge">.rubocop.yml</code>)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># http://blog.trk.in.rs/2021/02/06/rubocop/
# ~/.rubocop.yml is used when there is no local .rubocop.yml
AllCops:
  Exclude:
    - db/schema.rb
    - node_modules/**/*
    - db/migrate/*

# 'class ActionDispatch::IntegrationTest' in single line, no need two lines
Style/ClassAndModuleChildren:
  Enabled: false

# it is OK that code explains instead top-level class documentation comment
Style/Documentation:
  Enabled: false

# config, tasks and test for setup data could be very long
Metrics/BlockLength:
  Exclude:
    - 'lib/**/*'
    - 'test/**/*'
    - 'config/**/*'

# big test big ABC size
Metrics/AbcSize:
  Max: 25
  Exclude:
    - 'test/**/*'

# line length is not important in db and tests
Layout/LineLength:
  Max: 135
  Exclude:
    - 'db/**/*'
    - 'test/**/*'
    - 'spec/**/*'

# put comma after each line [1,]
Style/TrailingCommaInArrayLiteral:
  Enabled: false

# put comma after each line {a:1,}
Style/TrailingCommaInHashLiteral:
  Enabled: false

# also in arguments
Style/TrailingCommaInArguments:
  Enabled: false

# methods in 10 lines are OK but some are bigger
Metrics/MethodLength:
  Max: 15
  Exclude:
    - 'lib/**/*'
    - 'test/**/*'

# classes could be huge in tests
Metrics/ClassLength:
  Exclude:
    - 'test/**/*'

# do not need to write # frozen_string_literal: true
Style/FrozenStringLiteralComment:
  Enabled: false

# Rails:
#   Enabled: true

# Rails/FilePath:
#   Enabled: false

# errors.add(:base, 'Failed') and return false # no need to use &amp;&amp;
Style/AndOr:
  Enabled: false

# assert_match /regexp/, response.body # no need for parenthesis
Lint/AmbiguousRegexpLiteral:
  Enabled: false

# s = %q{Hi} # no need to use `%q` only for strings that contain both single quotes and double quotes
# Style/UnneededPercentQ:
# Style/RedudantPercentQ:
#   Enabled: false

# class Post &lt; ActiveRecord::Base # no need to subclass `ApplicationRecord`
# Rails/ApplicationRecord:
#   Enabled: false

# $:.push File.expand_path('lib', __dir__) # no need to use $LOAD_PATH
Style/SpecialGlobalVars:
  Enabled: false

# in scripts I like to define methods at the end using BEGIN block
Style/BeginBlock:
  Enabled: false

# use refute_ instead of assert_not _ in minitest
# Rails/RefuteMethods:
#   Enabled: false

# port: (Rails.env.production? ? nil : Rails.env.development? ? Rack::Server.new.options[:Port] : 3333),
Style/NestedTernaryOperator:
  Enabled: false

Style/LambdaCall:
  Enabled: false
# method(*%i[a b])
# Lint/UnneededSplatExpansion:
# Lint/RedudantSplatExpansion:
#   Enabled: false

# new pending cops
Style/HashEachMethods:
  Enabled: true
Style/HashTransformKeys:
  Enabled: true
Style/HashTransformValues:
  Enabled: true

# use two spaces for indent
Layout/MultilineMethodCallIndentation:
  EnforcedStyle: indented

# Use attr_accessor in different places, near the related usage
Style/AccessorGrouping:
  Enabled: false
</code></pre></div></div>
</body>
  </article>

  
  
  
  
    
  
  
  
  
  
  
  
  

</div>

      </div>
    </div>

    <style type='text/css'>
      .similar-links {
        display: inline-block;
        padding: 10px;
      }
    </style>
    <footer class="site-footer">

      <div class="wrap">

        <h2 class="footer-heading">duleorlovic - web developer</h2>

        <div class="footer-col-1 column">
          <ul>
            <li><a href="http://duleorlovic.github.io/tips/">short indistinct tips</a></li>
          </ul>
        </div>

        <div class="footer-col-2 column">
          <ul>
            <li>
              <a href="https://github.com/duleorlovic">
                <span class="icon github">
                  <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                     viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                    c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                    c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                    c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                    C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                    c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                    c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                    c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                    c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                  </svg>
                </span>
                <span class="username">duleorlovic</span>
              </a>
            </li>
          </ul>
        </div>

        <div class="footer-col-3 column">
          <p class="text">I am writing here some toughts during my work in Ruby on Rails, Javascript and other</p>
        </div>

      </div>

    </footer>

  </body>
</html>
